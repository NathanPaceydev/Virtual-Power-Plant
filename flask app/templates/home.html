{% extends "base.html" %}

{% block title %}Home Page{% endblock %}

{% block content %}

    <!-- Popup Overlay -->
    <div id="loadingOverlay" class="overlay" style="display:none;">
        <div class="popup">
            <div class="loader"></div>
            <p>Getting your specific location data from NREL databases. One moment...</p>
        </div>
    </div>

    <style>
        /* Custom styles for the submit button */
        input[type="submit"] {
            font-size: 20px; /* Larger font size */
            padding: 10px 20px; /* Larger padding */
            cursor: pointer; /* Hand cursor on hover */
        }

        /* Hidden by default */
        .loading-message {
            display: none;
            margin-top: 20px;
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Popup */
        .popup {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        /* Solar Panel Loader */
        .loader {
            border: 5px solid #f3f3f3;
            border-radius: 50%;
            border-top: 5px solid #444;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }


        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        table, th, td {
            border: 1px solid #ddd;
            text-align: left;
        }
        
        th, td {
            padding: 8px;
        }
        
        th {
            background-color: #f2f2f2;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>

    <h1>Virtual Power Plant Toolkit</h1>

    <form method="post">

        <label for="surfaceArea">Surface Area (m<sup>2</sup>):</label>
        <input type="number" id="surfaceArea" name="surfaceArea"><br><br>

        <label for="postalCode">Postal Code:</label>
        <input type="text" id="postalCode" name="postalCode" pattern="[A-Za-z0-9]{3,}"><br><br>

        <label for="arrayType">Array Type:</label>
        <select id="arrayType" name="arrayType">
            <option value=0>Fixed Open Rack</option>
            <option value=1>Fixed - Roof Mounted</option>
            <option value=2>1-Axis Tracking</option>
            <option value=3>1-Axis Backtracking</option>
            <option value=4>2-Axis</option>
        </select><br><br>

        <label for="moduleType">Module Type:</label>
        <select id="moduleType" name="moduleType">
            <option value=1>Standard</option>
            <option value=2>Premium</option>
            <option value=3>Thin Film</option>
        </select><br><br>

        <label for="tilt">Tilt (0 to 90 degrees):</label>
        <input type="range" id="tilt" name="tilt" min="0" max="90" step="1" oninput="this.nextElementSibling.value = this.value">
        <output>45</output><br><br>

        <!-- New input field for the number of wind turbines -->
        <label for="numTurbines">Number of Wind Turbines:</label>
        <input type="number" id="numTurbines" name="numTurbines" min="1" step="1">
        <br><br>

        <input type="submit" value="Submit">
    </form>

    <br><br><br><br>
    <h2>Equipment details</h2>
    <!-- Add a table here with the details of each equipment selected, solar pannels, wind turbine, battery-->
    <table>
        <thead>
            <tr>
                <th>Equipment Type</th>
                <th>Model</th>
                <th>Capacity</th>
                <th>Data Sheet</th>
                <th>Total Capacity</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Solar Panels</td>
                <td>Model SP123</td>
                <td>300W</td>
                <td><a href="{{ url_for('static', filename='datasheets/Bauer-Solar-CANSOLAR (1).pdf') }}" target="_blank">Download</a></td>
                <td>3kW</td>
            </tr>
            <tr>
                <td>Wind Turbine</td>
                <td>Model WT456</td>
                <td>1.5kW</td>
                <td>
                    <a href="{{ url_for('static', filename='datasheets/Aeolos-H 100kW Brochure 8012024 (1).pdf') }}" target="_blank">Brochure PDF</a>
                    <p> </p>
                    <a href="{{ url_for('static', filename='datasheets/Aeolos H 100kW on grid and off grid price list 2012024 (1).pdf') }}" target="_blank">Pricing PDF</a>
                </td>
                <td>3kW</td>
            </tr>
            <tr>
                <td>Battery</td>
                <td>Model B789</td>
                <td>5kWh</td>
                <td><a href="{{ url_for('static', filename='datasheets/Ficha-Tecnica-Mega-Pack (1).pdf') }}" target="_blank">Download</a></td>
                <td>20kWh</td>
            </tr>
        </tbody>
    </table>
    
    <script>
        document.querySelector('form').addEventListener('submit', function(e) {
            e.preventDefault();  // Prevent the default form submission
    
            // Show the loading overlay
            document.getElementById('loadingOverlay').style.display = 'flex';
    
            // Collect the form data
            const formData = new FormData(e.target);
    
            // Make an asynchronous request to your Flask route
            fetch('/solar', {  // Make sure to use the correct endpoint for your solar page
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.text();  // or response.json() if your server returns JSON
            })
            .then(html => {
                document.open();
                document.write(html);  // Replace the current page with the response page
                document.close();
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });
        });
    </script>
    

{% endblock %}

